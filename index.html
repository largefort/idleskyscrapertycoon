
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Idle Skyscraper Tycoon</title>

<meta name="viewport"
      content="width=device-width, initial-scale=1.0,
               maximum-scale=1.0, user-scalable=no">

<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<link rel="stylesheet" href="https://unpkg.com/material-components-web@14.0.0/dist/material-components-web.min.css">

<style>
html, body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  overflow: hidden;
  background: #e6ebef;
  font-family: Roboto, Arial, sans-serif;
  touch-action: manipulation;
}

/* HEADER */
header {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  height: 56px;
  background: linear-gradient(90deg, #5e35b1, #673ab7);
  color: white;
  display: flex;
  align-items: center;
  padding: 0 16px;
  font-size: 18px;
  z-index: 10;
  box-shadow: 0 3px 8px rgba(0,0,0,0.25);
}

/* CANVAS FULLSCREEN */
#gameCanvas {
  position: absolute;
  top: 56px;
  left: 0;
  width: 100vw;
  height: calc(100vh - 56px);
  background: linear-gradient(#b0bec5, #e6ebef);
}

/* HUD */
#hud {
  position: fixed;
  top: 72px;
  left: 16px;
  background: rgba(255,255,255,0.92);
  border-radius: 10px;
  padding: 12px 16px;
  box-shadow: 0 6px 18px rgba(0,0,0,0.2);
  z-index: 10;
}

.stat {
  font-size: 14px;
  margin: 4px 0;
}

/* BUILD BUTTON */
#buildBtn {
  position: fixed;
  bottom: 28px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 10;
  box-shadow: 0 8px 20px rgba(0,0,0,0.3);
}

button[disabled] {
  opacity: 0.6;
}
</style>
</head>

<body>

<header>üèôÔ∏è Idle Skyscraper Tycoon</header>

<div id="hud">
  <div class="stat">Money: <strong id="money">$0</strong></div>
  <div class="stat">Floors: <strong id="floors">0</strong></div>
  <div class="stat">Income/sec: <strong id="income">$0</strong></div>
</div>

<canvas id="gameCanvas"></canvas>

<button id="buildBtn"
        class="mdc-button mdc-button--raised"
        onclick="buildFloor()">
  <span class="mdc-button__label" id="buildLabel">
    Build Floor ($0)
  </span>
</button>

<script>
/* =========================
   DISABLE PINCH ZOOM
========================= */
["gesturestart","gesturechange","gestureend"]
  .forEach(e => document.addEventListener(e, ev => ev.preventDefault()));

/* =========================
   CONSTANTS
========================= */
const TENANTS = {
  office:     { income: 2,  color: "#90caf9" },
  startup:    { income: 3,  color: "#81d4fa" },
  shop:       { income: 4,  color: "#a5d6a7" },
  cafe:       { income: 5,  color: "#ffab91" },
  hotel:      { income: 6,  color: "#ce93d8" },
  tech:       { income: 7,  color: "#64b5f6" },
  luxury:     { income: 8,  color: "#ffcc80" },
  penthouse:  { income: 12, color: "#ffd54f" }
};

const BASE_FLOOR_COST = 60;
const LINEAR_COST = 12;
const EXP_START = 30;
const EXP_RATE = 1.06;

const BUILD_TIME = 800;
const FLOOR_HEIGHT = 28;
const FLOOR_MARGIN = 3;
const GROUND_PADDING = 120;

/* =========================
   GAME STATE
========================= */
let game = {
  money: 60,
  floors: []
};

/* =========================
   SAVE / LOAD
========================= */
function saveGame() {
  localStorage.setItem("skyscraperTycoon", JSON.stringify(game));
}

function loadGame() {
  const d = JSON.parse(localStorage.getItem("skyscraperTycoon") || "{}");
  game.money = Math.max(d.money ?? 60, 60);
  game.floors = d.floors || [];
}

/* =========================
   ECONOMY
========================= */
function floorCost() {
  const n = game.floors.length;
  const linear = n * LINEAR_COST;
  const exp = n > EXP_START ? Math.pow(EXP_RATE, n - EXP_START) * BASE_FLOOR_COST : 0;
  return Math.floor(BASE_FLOOR_COST + linear + exp);
}

function incomePerSecond() {
  return game.floors
    .filter(f => Date.now() >= f.builtAt)
    .reduce((s, f) => s + TENANTS[f.tenant].income, 0);
}

function addOnlineIncome() {
  game.money += incomePerSecond();
}

function buildFloor() {
  const cost = floorCost();
  if (game.money < cost) return;

  const keys = Object.keys(TENANTS);
  game.money -= cost;
  game.floors.push({
    tenant: keys[Math.random() * keys.length | 0],
    builtAt: Date.now() + BUILD_TIME
  });

  saveGame();
}

/* =========================
   CANVAS + CAMERA
========================= */
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

let cameraY = 0, targetCameraY = 0;

function resizeCanvas() {
  canvas.width = innerWidth;
  canvas.height = innerHeight - 56;
}
addEventListener("resize", resizeCanvas);
resizeCanvas();

/* =========================
   RENDER
========================= */
function drawSkyscraper() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  const sky = ctx.createLinearGradient(0,0,0,canvas.height);
  sky.addColorStop(0,"#90a4ae");
  sky.addColorStop(1,"#eceff1");
  ctx.fillStyle = sky;
  ctx.fillRect(0,0,canvas.width,canvas.height);

  const width = 160;
  const baseX = (canvas.width - width) / 2;
  const visibleHeight = canvas.height - GROUND_PADDING;
  const towerHeight = game.floors.length * FLOOR_HEIGHT;

  targetCameraY = Math.max(0, towerHeight - visibleHeight);
  cameraY += (targetCameraY - cameraY) * 0.08;

  let y = canvas.height - FLOOR_MARGIN + cameraY;

  game.floors.forEach(f => {
    y -= FLOOR_HEIGHT;
    const built = Date.now() >= f.builtAt;
    const progress = built ? 1 : Math.max(0, 1 - (f.builtAt - Date.now()) / BUILD_TIME);
    const offset = FLOOR_HEIGHT * (1 - progress);

    ctx.fillStyle = built ? TENANTS[f.tenant].color : "#b0bec5";
    ctx.fillRect(baseX, y + offset, width, FLOOR_HEIGHT - FLOOR_MARGIN);

    ctx.fillStyle = "rgba(0,0,0,0.08)";
    ctx.fillRect(baseX + width - 10, y + offset, 10, FLOOR_HEIGHT - FLOOR_MARGIN);

    if (built) {
      ctx.fillStyle = "rgba(255,255,255,0.55)";
      for (let i = 1; i < 5; i++) {
        ctx.fillRect(baseX + i * 30 - 5, y + 6, 8, 10);
      }
    }
  });

  ctx.fillStyle = "#455a64";
  ctx.fillRect(baseX - 20, canvas.height - 8, width + 40, 8);
}

/* =========================
   UI & LOOPS
========================= */
function updateUI() {
  money.textContent = "$" + Math.floor(game.money);
  floors.textContent = game.floors.length;
  income.textContent = "$" + incomePerSecond();
  const cost = floorCost();
  buildLabel.textContent = `Build Floor ($${cost})`;
  buildBtn.disabled = game.money < cost;
}

function tick() {
  addOnlineIncome();
  saveGame();
  updateUI();
}

function renderLoop() {
  drawSkyscraper();
  requestAnimationFrame(renderLoop);
}

/* =========================
   INIT
========================= */
loadGame();
updateUI();
setInterval(tick, 1000);
requestAnimationFrame(renderLoop);
</script>

</body>
</html>
