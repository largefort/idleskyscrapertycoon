<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Idle Skyscraper Tycoon</title>

<meta name="viewport"
      content="width=device-width, initial-scale=1.0,
               maximum-scale=1.0, user-scalable=no">

<style>
html, body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  overflow: hidden;
  background: #e6ebef;
  font-family: Roboto, Arial, sans-serif;
}

header {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  height: 56px;
  background: linear-gradient(90deg, #5e35b1, #673ab7);
  color: white;
  display: flex;
  align-items: center;
  padding: 0 16px;
  font-size: 18px;
  z-index: 10;
}

#gameCanvas {
  position: absolute;
  top: 56px;
  left: 0;
  width: 100vw;
  height: calc(100vh - 56px);
}

#hud {
  position: fixed;
  top: 72px;
  left: 16px;
  background: rgba(255,255,255,0.92);
  border-radius: 10px;
  padding: 12px 16px;
  box-shadow: 0 6px 18px rgba(0,0,0,0.2);
  z-index: 10;
}

.stat { font-size: 14px; margin: 4px 0; }

#buildBtn {
  position: fixed;
  bottom: 28px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 10;
}
</style>
</head>

<body>

<header>üèôÔ∏è Idle Skyscraper Tycoon</header>

<div id="hud">
  <div class="stat">Money: <strong id="money">$0</strong></div>
  <div class="stat">Floors: <strong id="floors">0</strong></div>
  <div class="stat">Income/sec: <strong id="income">$0</strong></div>
</div>

<canvas id="gameCanvas"></canvas>

<button id="buildBtn" onclick="buildFloor()">
  <span id="buildLabel">Build Floor ($0)</span>
</button>

<script>
/* =========================
   FLOOR TYPES
========================= */
const FLOOR_TYPES = [
  { id: "office", name: "Office", income: 2, color: "#90caf9", unlock: 0 },
  { id: "retail", name: "Retail", income: 4, color: "#a5d6a7", unlock: 0 },
  { id: "residential", name: "Residential", income: 3, color: "#ffcc80", unlock: 0 },
  { id: "hotel", name: "Hotel", income: 7, color: "#ce93d8", unlock: 20 },
  { id: "hq", name: "Corporate HQ", income: 12, color: "#ef5350", unlock: 50 },
  { id: "penthouse", name: "Penthouse", income: 25, color: "#ffd54f", unlock: 100 }
];

/* =========================
   ECONOMY
========================= */
const BASE_FLOOR_COST = 60;
const LINEAR_COST = 12;
const EXP_START = 30;
const EXP_RATE = 1.06;

const FLOOR_HEIGHT = 28;
const BUILD_TIME = 800;
const GROUND_PADDING = 120;

/* =========================
   GAME STATE
========================= */
let game = {
  money: 60,
  floors: [],
  lastTick: Date.now()
};

/* =========================
   SAVE / LOAD
========================= */
function saveGame() {
  localStorage.setItem("skyscraperTycoon", JSON.stringify(game));
}
function loadGame() {
  const d = JSON.parse(localStorage.getItem("skyscraperTycoon") || "{}");
  game.money = Math.max(d.money ?? 60, 60);
  game.floors = d.floors || [];
  game.lastTick = d.lastTick || Date.now();
}

/* =========================
   CORE LOGIC
========================= */
function floorCost() {
  const n = game.floors.length;
  const linear = n * LINEAR_COST;
  const exp = n > EXP_START ? Math.pow(EXP_RATE, n - EXP_START) * BASE_FLOOR_COST : 0;
  return Math.floor(BASE_FLOOR_COST + linear + exp);
}

function availableFloorTypes() {
  return FLOOR_TYPES.filter(f => game.floors.length >= f.unlock);
}

function pickFloorType() {
  const available = availableFloorTypes();
  return available[Math.random() * available.length | 0];
}

function incomePerSecond() {
  return game.floors.reduce(
    (sum, f) => sum + (Date.now() >= f.builtAt ? f.income : 0),
    0
  );
}

function buildFloor() {
  const cost = floorCost();
  if (game.money < cost) return;

  const type = pickFloorType();

  game.money -= cost;
  game.floors.push({
    type: type.id,
    income: type.income,
    color: type.color,
    builtAt: Date.now() + BUILD_TIME
  });

  saveGame();
}

/* =========================
   OFFLINE INCOME
========================= */
function applyOfflineIncome() {
  const now = Date.now();
  const elapsed = ((now - game.lastTick) / 1000) | 0;
  if (elapsed > 0) game.money += incomePerSecond() * elapsed;
  game.lastTick = now;
}

/* =========================
   CANVAS + CAMERA
========================= */
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
let cameraY = 0, targetCameraY = 0;

function resize() {
  canvas.width = innerWidth;
  canvas.height = innerHeight - 56;
}
addEventListener("resize", resize);
resize();

/* =========================
   RENDER
========================= */
function draw() {
  ctx.clearRect(0,0,canvas.width,canvas.height);

  const sky = ctx.createLinearGradient(0,0,0,canvas.height);
  sky.addColorStop(0,"#90a4ae");
  sky.addColorStop(1,"#eceff1");
  ctx.fillStyle = sky;
  ctx.fillRect(0,0,canvas.width,canvas.height);

  const width = 160;
  const baseX = (canvas.width - width) / 2;

  const visibleHeight = canvas.height - GROUND_PADDING;
  const towerHeight = game.floors.length * FLOOR_HEIGHT;
  targetCameraY = Math.max(0, towerHeight - visibleHeight);
  cameraY += (targetCameraY - cameraY) * 0.08;

  let y = canvas.height + cameraY;

  game.floors.forEach(f => {
    y -= FLOOR_HEIGHT;
    ctx.fillStyle = f.color;
    ctx.fillRect(baseX, y, width, FLOOR_HEIGHT - 3);

    ctx.fillStyle = "rgba(0,0,0,0.1)";
    ctx.fillRect(baseX + width - 10, y, 10, FLOOR_HEIGHT - 3);
  });

  ctx.fillStyle = "#455a64";
  ctx.fillRect(baseX - 30, canvas.height - 8, width + 60, 8);
}

/* =========================
   UI
========================= */
function updateUI() {
  money.textContent = "$" + Math.floor(game.money);
  floors.textContent = game.floors.length;
  income.textContent = "$" + incomePerSecond();
  buildLabel.textContent = `Build Floor ($${floorCost()})`;
}

/* =========================
   LOOPS
========================= */
function tick() {
  applyOfflineIncome();
  saveGame();
  updateUI();
}

function loop() {
  draw();
  requestAnimationFrame(loop);
}

/* =========================
   INIT
========================= */
loadGame();
applyOfflineIncome();
updateUI();
setInterval(tick, 1000);
loop();
</script>

</body>
</html>
